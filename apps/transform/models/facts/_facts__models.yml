version: 2

models:
  - name: fct_time_records_actual
    description: "Actual time records with category mapping and continuous time adjustment"
    columns:
      - name: id
        data_tests: [unique, not_null]
      - name: source_id
        data_tests: [not_null]
      - name: start_at
        data_tests: [not_null]
      - name: end_at
        data_tests: [not_null]
      - name: duration_seconds
        data_tests: [not_null]
      - name: social_category
        data_tests: [not_null]
      - name: personal_category
        data_tests: [not_null]
      - name: source
        data_tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['toggl_track', 'generated']

  - name: fct_time_records_actual_split
    description: "Actual time records split by JST day boundary"
    columns:
      - name: id
        data_tests: [unique, not_null]
      - name: source_id
        data_tests: [not_null]
      - name: start_at
        data_tests: [not_null]
      - name: end_at
        data_tests: [not_null]
      - name: duration_seconds
        data_tests: [not_null]
      - name: source
        data_tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['toggl_track', 'generated']

  - name: fct_health_sleep
    description: "Daily sleep fact from Fitbit (main sleep only, one row per sleep_date)"
    columns:
      - name: id
        data_tests: [not_null]
      - name: sleep_date
        data_tests: [unique, not_null]
      - name: start_at
        data_tests: [not_null]
      - name: duration_seconds
        data_tests: [not_null]

  - name: fct_health_body
    description: "Daily body composition fact from Tanita Health Planet"
    columns:
      - name: id
        data_tests: [not_null]
      - name: measured_date
        data_tests: [unique, not_null]
      - name: weight
        data_tests: [not_null]

  - name: fct_zaim_transactions
    description: "Zaim transactions with category/genre/account names joined"
    columns:
      - name: id
        data_tests: [not_null]
      - name: source_id
        data_tests: [not_null]
      - name: mode
        data_tests:
          - not_null
          - accepted_values:
              values: ['income', 'payment', 'transfer']
      - name: transaction_date
        data_tests: [not_null]
      - name: amount
        data_tests: [not_null]
